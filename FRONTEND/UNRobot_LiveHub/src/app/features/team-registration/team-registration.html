<div class="max-w-3xl mx-auto">
  <app-back-button />
  
  <h1 class="font-heading text-4xl font-bold text-unrobot-blue mb-8">
    Registro de Nuevo Equipo
  </h1>
  <p class="font-sans text-lg text-gray-700 mb-8">
    Introduce los datos del equipo que deseas inscribir en la competencia.
  </p>

  <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()" 
        class="bg-white p-8 rounded-lg shadow-lg border border-gray-200 space-y-6">

    <div *ngIf="errorMessage" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4">
      <p class="font-bold">Error:</p>
      <p>{{ errorMessage }}</p>
    </div>
    <div *ngIf="successMessage" class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4">
      <p class="font-bold">Éxito:</p>
      <p>{{ successMessage }}</p>
    </div>

    <div>
      <label for="nombre" class="block text-sm font-medium text-gray-700">Nombre del Equipo</label>
      <input id="nombre" type="text" formControlName="nombre" [class.border-red-500]="isInvalid('nombre')"
             class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg ...">
      <div *ngIf="isInvalid('nombre')" class="text-red-600 text-sm mt-1">
        Se requiere un nombre de equipo.
      </div>
    </div>

    <div>
      <label for="institucion" class="block text-sm font-medium text-gray-700">Institución (Opcional)</label>
      <input id="institucion" type="text" formControlName="institucion"
             class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg ...">
    </div>

    <div>
      <label for="categoriaTipo" class="block text-sm font-medium text-gray-700">Categoría a Inscribir</label>
      <select id="categoriaTipo" formControlName="categoriaTipo" [class.border-red-500]="isInvalid('categoriaTipo')"
              class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg ...">
        <option value="" disabled>-- Selecciona una categoría --</option>
        <ng-container *ngIf="categories$ | async as categories">
          <option *ngFor="let category of categories" [value]="category.tipo">
            {{ category.nombreCompleto }} ({{ category.tipoLogica }})
          </option>
        </ng-container>
      </select>
      <div *ngIf="isInvalid('categoriaTipo')" class="text-red-600 text-sm mt-1">
        Debes seleccionar una categoría.
      </div>
    </div>

    <hr class="my-4">

    <div>
      <label for="nombreCapitan" class="block text-sm font-medium text-gray-700">Nombre del Capitán</label>
      <input id="nombreCapitan" type="text" formControlName="nombreCapitan" [class.border-red-500]="isInvalid('nombreCapitan')"
             class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg ...">
      <div *ngIf="isInvalid('nombreCapitan')" class="text-red-600 text-sm mt-1">
        Se requiere el nombre del capitán.
      </div>
    </div>

    <div>
      <label for="emailCapitan" class="block text-sm font-medium text-gray-700">Email del Capitán</label>
      <input id="emailCapitan" type="email" formControlName="emailCapitan" [class.border-red-500]="isInvalid('emailCapitan')"
             class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg ...">
      <div *ngIf="isInvalid('emailCapitan')" class="text-red-600 text-sm mt-1">
        <span *ngIf="registrationForm.get('emailCapitan')?.errors?.['required']">Se requiere un email.</span>
        <span *ngIf="registrationForm.get('emailCapitan')?.errors?.['email']">Debe ser un email válido.</span>
      </div>
    </div>

    <div>
      <label for="telefonoCapitan" class="block text-sm font-medium text-gray-700">Teléfono del Capitán (Opcional)</label>
      <input id="telefonoCapitan" type="tel" formControlName="telefonoCapitan"
             class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg ...">
    </div>

    <hr class="my-4">

    <div>
      <h3 class="text-lg font-medium text-gray-900 mb-2">Otros Miembros (Opcional)</h3>
      
      <div formArrayName="miembros" class="space-y-3">
        
        <div *ngFor="let member of miembros.controls; let i = index" 
             class="flex items-center space-x-2">
          
          <input 
            [formControlName]="i" 
            placeholder="Nombre completo del miembro {{ i + 1 }}"
            class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm ...">
          
          <button 
            type="button" 
            (click)="removeMember(i)"
            class="px-3 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
          </button>
        </div>
      </div>

      <button 
        type="button" 
        (click)="addMember()"
        class="mt-4 px-4 py-2 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 transition-colors">
        + Añadir Miembro
      </button>
    </div>
    
    <button 
      type="submit"
      [disabled]="registrationForm.invalid || isLoading"
      class="w-full py-4 px-6 rounded-lg font-heading font-semibold text-lg transition-colors
             bg-unrobot-blue text-white
             hover:bg-opacity-90
             focus:outline-none focus:ring-2 focus:ring-unrobot-gold
             disabled:bg-gray-400 disabled:cursor-not-allowed">
      {{ isLoading ? 'Registrando...' : 'Registrar Equipo' }}
    </button>
  </form>
</div>